<!DOCTYPE html>
<html lang="ru">

  <head>
    <title>Программирование&amp;Музыка: Частотный фильтр Баттервота. Часть 3 &#x2F; Хабр</title>

































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
  </head>
  <body>
    
    <div id="mount"><div id="app"><div class="tm-layout__wrapper"><!--[--><!----><div></div><div class="header-banner-wrapper"><div class="element-wrapper above-header" style="--754c4550:100%;--56cb6579:auto;"><!--[--><div class="placeholder-wrapper banner-container__placeholder"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="adfox-banner-placeholder above-header" data-v-24012b5e><div class="image loads" data-v-24012b5e></div><div class="lines" data-v-24012b5e><div class="line loads" data-v-24012b5e></div><div class="line loads" data-v-24012b5e></div><div class="line loads" data-v-24012b5e></div></div></div><!----><!----><!----></div><!--[--><div id="adfox_175449164307199013_aboveHeader" class="banner-target"></div><!--]--><!--]--></div></div><header class="tm-header tm-header" data-test-id="header"><!----><!----><div class="tm-page-width"><!--[--><div class="tm-header__container"><button aria-expanded="false" aria-label="Toggle menu" class="burger-button tm-header__button tm-header__burger" data-v-56ed7aae><span class="line top" data-v-56ed7aae></span><span class="line middle" data-v-56ed7aae></span><span class="line bottom" data-v-56ed7aae></span></button><span class="tm-header__logo-wrap"><a class="tm-header__logo tm-header__logo_hl-ru tm-header__logo" href="/ru/feed"><svg class="tm-svg-img tm-header__icon" height="16" width="16"><title>Хабр</title><use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a></span><span class="tm-header__divider"></span><!--[--><a class="tm-header__all-flows" href="/ru/articles/">Все потоки</a><!--]--><!----><div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search" data-test-id="search-button"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search" height="24" width="24"><title>Поиск</title><use xlink:href="/img/megazord-v28.cba4c116..svg#search"></use></svg></a><!----><!----><div class="tm-header-user-menu__item tm-header-user-menu__write"><a href="/ru/sandbox/start/" class=""><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_write" height="24" width="24"><title>Написать публикацию</title><use xlink:href="/img/megazord-v28.cba4c116..svg#write"></use></svg></a><!----></div><!--[--><div class="tm-header-user-menu__item"><button class="tm-header-user-menu__toggle" data-test-id="user-menu-settings"><svg class="tm-svg-img tm-header-user-menu__icon" height="24" width="24"><title>Настройки</title><use xlink:href="/img/megazord-v28.cba4c116..svg#page-settings"></use></svg></button></div><a href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/articles/313062/&amp;hl=ru" rel="nofollow" class="tm-header-user-menu__item tm-header-user-menu__login" role="button"><!--[-->Войти<!--]--></a><!--]--><template><!----></template><!--teleport start--><!--teleport end--></div></div><!--]--></div></header><div class="tm-layout"><div class="tm-page-progress-bar"></div><!----><div class="tm-page-width"><!--[--><!----><!----><!----><!--]--></div><main class="tm-layout__container"><div class="tm-page" hl="ru" data-async-called="true" style="--a414e232:300px;--10c4682a:0;--19620736:0;"><!----><div class="tm-page-width"><!--[--><!----><div class="tm-page__wrapper"><!----><div class="tm-page__main_has-sidebar tm-page__main"><div class="pull-down"><!----><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg class="tm-svg-img pull-down__icon pull-down__arrow" height="24" width="24"><title>Обновить</title><use xlink:href="/img/megazord-v28.cba4c116..svg#pull-arrow"></use></svg></div></div><!--[--><div><!--[--><!----><div class="tm-article-presenter" data-async-called="true"><!--[--><!--]--><div class="tm-article-presenter__body" data-test-id="article-body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><!--[--><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><!--[--><div class="tm-article-presenter__header"><!--[--><!--]--><div class="article-snippet tm-article-presenter__snippet" data-v-085cd854><!--[--><!--]--><div class="meta-container" data-v-085cd854><div class="meta" data-v-085cd854><span class="tm-user-info author" data-v-085cd854><a href="/ru/users/lis355/" class="tm-user-info__userpic" data-test-id="user-info-pic"><!--[--><div class="tm-entity-image"></div><!--]--></a><span class="tm-user-info__user tm-user-info__user_appearance-default" data-test-id="user-info-description"><a href="/ru/users/lis355/" class="tm-user-info__username" data-test-id="user-info-username"><!--[-->lis355<!--]--></a><!----><!--[--><span class="tm-article-datetime-published" data-v-085cd854><time data-allow-mismatch datetime="2016-10-19T01:40:21.000Z" title="2016-10-19, 01:40">19  окт  2016 в 01:40</time></span><!--]--></span></span></div><div class="controls" data-v-085cd854><!----><!----><!----><!----></div></div><h1 class="tm-title tm-title_h1" lang="ru" data-test-id="articleTitle" data-v-085cd854><span>Программирование&Музыка: Частотный фильтр Баттервота. Часть 3</span></h1><div class="stats" data-test-id="articleStats" data-v-085cd854><!----><div class="tm-article-reading-time" data-v-085cd854><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Время на прочтение</title><use xlink:href="/img/megazord-v28.cba4c116..svg#clock"></use></svg></span><span class="tm-article-reading-time__label">12 мин</span></div><span class="tm-icon-counter tm-data-icons__item reach-counter" data-v-085cd854><svg class="tm-svg-img tm-icon-counter__icon" height="24" width="24"><title>Охват и читатели</title><use xlink:href="/img/megazord-v28.cba4c116..svg#counter-views"></use></svg><span class="tm-icon-counter__value" title="32361">32K</span></span></div><div class="tm-publication-hubs__container" data-test-id="articleHubsList" data-v-085cd854><div class="tm-publication-hubs"><!--[--><span class="tm-publication-hub__link-container"><a href="/ru/hubs/net/" class="tm-publication-hub__link"><!--[--><span>.NET</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб"> * </span><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/algorithms/" class="tm-publication-hub__link"><!--[--><span>Алгоритмы</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб"> * </span><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/programming/" class="tm-publication-hub__link"><!--[--><span>Программирование</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб"> * </span><!--]--></a></span><!--]--></div></div><div class="tm-article-labels" data-test-id="articleLabels" data-v-085cd854 data-v-bfa2437b><div class="tm-article-labels__container" data-v-bfa2437b><!----><!--[--><!----><!--[--><!--]--><!--]--></div></div><!----><!----><!--teleport start--><!--teleport end--></div></div><!--[--><!----><div class="article-body" data-gallery-root lang="ru" data-v-aad06d04><div data-v-aad06d04><!--[--><!--]--></div><div id="post-content-body" data-v-aad06d04><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><p>Всем привет! Вы читаете третью часть статьи про создание VST-синтезатора на С#. В предыдущих частях был рассмотрен SDK и библиотеки для создания <a href="https://ru.wikipedia.org/wiki/Virtual_Studio_Technology">VST</a> плагинов, рассмотрено программирование осциллятора и ADSR-огибающей для управления амплитудой сигнала.</p><br/>
<p>В этой части я расскажу, как рассчитать и закодить фильтр частот, без которого не обходится ни один синтезатор. А без эквалайзера немыслима обработка звука.</p><br/>
<p>Будет рассмотрен исходный код и применение эквалайзера из библиотеки <a href="https://naudio.codeplex.com/">NAudio</a> (библиотека для работы со звуком под .NET).</p><br/>
<p>Внимание — будет много <a href="https://habrastorage.org/files/29b/79e/889/29b79e8894a541e99e1e556ac3c5ebcf.jpg">матана</a> — будем рассчитывать формулы для коэффициентов фильтра.</p><br/>
<p>Исходный код <a href="https://www.youtube.com/watch?v=6zAVMEtIb2w">написанного мною синтезатора</a> доступен на <a href="https://github.com/lis355/Syntage">GitHub'е</a>.</p><br/>
<div style="text-align:center;"></div><br/>
<p><em>Скриншот VST плагина-эквалайзера Fab Filter Pro Q</em></p><br/>
<a name="habracut"></a><br/>
<h2 id="cikl-statey">Цикл статей</h2><br/>
<ol>
<li><a href="https://habrahabr.ru/post/311220/">Понимаем и пишем VSTi синтезатор на C# WPF</a></li>
<li><a href="https://habrahabr.ru/post/311750/">ADSR-огибающая сигнала</a></li>
<li>Частотный фильтр Баттервота</li>
<li><a href="https://habrahabr.ru/post/313338/">Delay, Distortion и модуляция параметров</a></li>
</ol><br/>
<h2 id="oglavlenie">Оглавление</h2><br/>
<ol>
<li><a href="#Part1">Эквалайзер</a></li>
<li><a href="#Part2">Фильтрация через преобразование Фурье</a></li>
<li><a href="#Part3">Цифровые фильтры</a></li>
<li><a href="#Part4">Почему фильтр Баттервота?</a></li>
<li><a href="#Part5">Вывод формулы фильтра НЧ</a></li>
<li><a href="#Part6">Вывод формулы фильтра ВЧ и полосового фильтра</a></li>
<li><a href="#Part7">Программирование фильтра Баттервота по полученным формулам</a></li>
<li><a href="#Part8">Полосовой эквалайзер в библиотеке NAudio</a></li>
<li><a href="#Part9">Программы для рассчета фильтров</a></li>
<li><a href="#Part10">Список литературы</a></li>
</ol><br/>
<a name="Part1"></a><br/>
<h2 id="ekvalayzer">Эквалайзер</h2><br/>
<p>Часто при обработке звука мы хотим изменить его характер/окраску/тембр. Сделать звук более басовым, убрать верхние частоты, или наоборот, сделать звук "прозрачным", оставив лишь середину и верха. Уверен, многие люди, не работавшие с обработкой звука, знают что такое <a href="http://ru.wikipedia.org/wiki/Эквалайзер">эквалайзер</a> — они есть акустических колонках, музыкальных центрах, магнитофонах, плеерах, и т.д. Эквалайзер — это набор фильтров, каждый из которых изменяет амплитуду сигнала в его выбранной полосе частот. На бытовых колонках это, обычно, 2-3 крутилки — низкие частоты, средние и верха, с фиксированными полосами частот.</p><br/>
<p>В Winamp'овском эквалайзере уже есть 10 заранее определенных полос.</p><br/>
<div style="text-align:center;"></div><br/>
<p><em>Скриншот эквалайзера в плеере Winamp</em></p><br/>
<p>В мире обработки звука существует множество плагинов-эквалайзеров, на любой вкус и цвет. Плагин Fab Filter Pro Q (скриншот в начале статьи) — это графический эквалайзер, позволяющий создавать большое число <em>полос</em> и редактировать их параметры.</p><br/>
<p>Каждая <em>полоса</em> в эквалайзере — это, по сути, фильтр частот. Фильтры частот изменяют тембральные/частотные характеристики сигнала. В электронике существуют много типов и классификаций фильтров, с соответствующими характеристиками и параметрами — <a href="http://ru.wikipedia.org/wiki/Фильтр_(электроника)">смотрим википедию</a>.<br/>
Мы рассмотрим и запрограммируем самые простые фильтры: НЧ, ВЧ и полосовой фильтры.</p><br/>
<a name="Part2"></a><br/>
<h2 id="filtraciya-cherez-preobrazovanie-fure">Фильтрация через преобразование Фурье</h2><br/>
<p>По идее, вам никто не мешает делать с сигналом <a href="https://habrahabr.ru/post/196374/">дискретное преобразование Фурье</a>, обработать частоты и затем сделать обратное преобразование.</p><br/>
<p>Если не думать над реализацией ДПФ, то такой подход я бы назвал достаточно интуитивным и простым в программировании (опять же, если взять ДПФ из какой-нибудь либы и не кодить самому).</p><br/>
<p>Минусы подхода — во-первых, ДПФ принимает на вход массив из семплов, размер которого является степенью двойки. Это значит, что выходной сигнал уже будет с задержкой. Во вторых, каждый 512-й семпл мы будем производить данный алгоритм: ДПФ, обработка частот сигнала, обратное ДФП. Это не малые вычисления. В-третьих, есть еще минусы и тонкости, которые знают адепты цифровой обработки сигналов.</p><br/>
<p>Мы не будем рассматривать применение ДПФ, а заглянем в теорию цифровых фильтров; напишем фильтр, который обрабатывает <em>значения семплов</em> и имеет линейную <a href="http://ru.wikipedia.org/wiki/Вычислительная_сложность">вычислительную сложность</a> в зависимости от длины входящего массива семплов.</p><br/>
<a name="Part3"></a><br/>
<h2 id="cifrovye-filtry">Цифровые фильтры</h2><br/>
<p>Большую часть информации и вывод формул я взял из книги <a href="https://www.amazon.com/Digital-Signal-Processing-Practical-Approach/dp/0201596199">Digital Signal Processing: A Practical Approach</a> — очень рекомендую, она есть в русской версии — <a href="https://www.ozon.ru/context/detail/id/5689080/">Цифровая обработка сигналов. Практический подход</a>, заинтересованные найдут PDF в сети.</p><br/>
<p>Хочу сделать <strong>важное замечание</strong>. Тема построения и рассчитывания фильтра действительно очень сложна, содержит массу тонкостей и нюансов, требует знания и понимания теории. В этой статье я покажу, как рассчитать формулы фильтра Баттервота, чтобы у читателя возникло понимание, откуда выводятся эти формулы. Но почему именно <em>такие</em> исходные формулы, почему именно <em>такие</em> замены — можно понять лишь погрузившись в глубокую теорию цифровой обработки сигналов.</p><br/>
<p>Когда я начинал гуглить код фильтров, я сразу находил множество непонятного математического кода, и хотелось хоть чуть-чуть понять, откуда берутся такие рассчетные формулы. Осциллятор, огибающая, дилей — понимание и программирование работы этих составляющих лично мне кажется интуитивным, но только не фильтров. Этой статьей я хочу пробудить интерес к цифровой обработке сигналов) Буду рад, если возникнет желание разобраться в этой теме более основательно.</p><br/>
<p>Вам нужно знать (хотя бы немножко) такие термины как <a href="http://ru.wikipedia.org/wiki/Свёртка_(математический_анализ)">свертка</a>, <a href="http://ru.wikipedia.org/wiki/Импульсная_переходная_функция">импульсная характеристика фильтра</a>, <a href="http://ru.wikipedia.org/wiki/Передаточная_функция">передаточная функция фильтра</a>.</p><br/>
<div style="text-align:center;"></div><br/>
<p><i>Аппроксимация <a href="http://ru.wikipedia.org/wiki/Амплитудно-частотная_характеристика">АЧХ</a> идеального фильтра (картинка из советского учебника, не нашел исходник)</i></p><br/>
<p>Фильтр изменяет сигнал, "убирая" в нем выбранные частоты. Существующие фильтры не идеальны. Полоса пропускания — полоса частот, которую фильтр "не затрагивает" (на графике есть некоторая  изменения — особенность неидеального представленного фильтра). Полоса подавления — полоса нежелательных частот. В полосе перехода происходит спад частот. Естественно, фильтр ближе к "идеальному" тем, насколько меньше он искажает полосу пропускания, насколько сильно он подавляет частоты в полосе подавления и насколько узка полоса перехода. Есть разные "приближения" фильтров — фильтр Чебышёва, Баттервота, и так далее — их вы найдете в книжках и на просторах сети.</p><br/>
<a name="Part4"></a><br/>
<h2 id="pochemu-filtr-battervota">Почему фильтр Баттервота?</h2><br/>
<p>Все очень просто, АЧХ фильтра Баттерворта максимально гладкая на частотах полосы пропускания — имхо, важнее всего не испортить сигнал в полосе пропускания.</p><br/>
<div style="text-align:center;"></div><br/>
<p><em>Логарифмическая АЧХ для фильтров Баттерворта нижних частот разных порядков (скриншот взят с Википедии)</em></p><br/>
<a name="Part5"></a><br/>
<h2 id="vyvod-formuly-filtra-nch">Вывод формулы фильтра НЧ</h2><br/>
<p><a href="http://ru.wikipedia.org/wiki/Передаточная_функция">Передаточная функция</a> для фильтра Баттервота на <a href="http://ru.wikipedia.org/wiki/S-плоскость">s-плоскости</a> записывается следующими формулами:</p><br/>
<p> при четных n и<br/>
 при нечетных n</p><br/>
<p>Здесь n — порядок фильтра: амплитуда на частоте среза w равна -3n dB, амплитудно-частотная характеристика затухает на −6n dB на октаву.</p><br/>
<p>Чтобы получить сверточные коэффициенты, нужно получить передаточную функцию на <a href="http://ru.wikipedia.org/wiki/Z-преобразование">z-плоскости</a> в виде</p><br/>
<div style="text-align:center;"></div><br/>
<p>Найдем передаточную функцию для фильтра второго порядка (затухание на -6 dB на октаву), подставляем в формулу для H(s) n = 2:</p><br/>
<div style="text-align:center;"></div><br/>
<p>Тогда свертка для фильтра будет выглядеть так:</p><br/>
<div style="text-align:center;"></div><br/>
<p>Пусть нам заданы частота среза w (на которой амплитуда сигнала будет -3 dB) и Fc — частота дискретизации (число семплов в секунду), в герцах.</p><br/>
<p>В формуле нужно использовать денормированные частоты, т.е. произвести замену (в полосовом фильтре будут две частоты w1 и w2, определяющие полосу пропускания):</p><br/>
<div style="text-align:center;"></div><br/>
<p>Если мы хотим рассчитывать НЧ-фильтр, то нужно сделать преобразование — произвести замену параметра s в передаточной функции:</p><br/>
<div style="text-align:center;"></div><br/>
<p>Для рассчета других типов фильтров (ВЧ, полосового, режекторного) нужно делать другие замены. Они рассмотрены в книге <a href="https://www.ozon.ru/context/detail/id/5689080/">Цифровая обработка сигналов. Практический подход</a> в части 8.8.2 и далее в статье.</p><br/>
<p>Далее, для перехода в z-плоскость делаем замену:</p><br/>
<div style="text-align:center;"></div><br/>
<p>Для аналитических рассчетов я использовал пакет Mathematica.</p><br/>
<div style="text-align:center;"></div><br/>
<p>Нужно получить числитель и знаменатель в виде полиномов от z. Приведем слагаемые знаменателя H(z) к общему знаменателю. Для этого найдем <a href="http://ru.wikipedia.org/wiki/Наибольший_общий_делитель">наибольший общий делитель (НОД, GCD)</a> слагаемых знаменателя и поделим на него числитель и знаменатель исходной функции H(z).</p><br/>
<div style="text-align:center;"></div><br/>
<p>Найдем коэффициенты при степенях у полученных полиномов, используя функцию CoefficientList:</p><br/>
<div style="text-align:center;"></div><br/>
<p>Если все делать честно, то, по условию, a0 должен быть равен 1 — поделим на a0 все коэффициенты (для кодинга будем использовать предыдущие формулы без деления):</p><br/>
<div style="text-align:center;"></div><br/>
<a name="Part6"></a><br/>
<h2 id="vyvod-formuly-filtra-vch-i-polosovogo-filtra">Вывод формулы фильтра ВЧ и полосового фильтра</h2><br/>
<p>Вывод формул для ВЧ-фильтра аналогичен НЧ-фильтру с другим преобразованием:</p><br/>
<div style="text-align:center;"></div><br/>
<div style="text-align:center;"></div><br/>
<p>Для вывода формул полосового фильтра применяется преобразование:</p><br/>
<div style="text-align:center;"></div><br/>
<p>Если производить замену, то степень полиномов в числителе и знаменателе H(z) удвоится (в замене есть s^2), значит порядок фильтра увеличится вдвое. Поэтому изначально используем функцию H(s) для n = 1:</p><br/>
<div style="text-align:center;"></div><br/>
<a name="Part7"></a><br/>
<h2 id="programmirovanie-filtra-battervota-po-poluchennym-formulam">Программирование фильтра Баттервота по полученным формулам</h2><br/>
<p>Фильтр будет иметь 2 параметра: тип фильтра (НЧ, ВЧ, полосовой) и частота среза w. Для полосового фильтра будем рассматривать частоту среза как частоту посередине полосы пропускания. Полосу пропускания же определим как отрезок частот [w — w/4, w + w/4] (можно придумать здесь более сложный и логичный здесь логарифмический закон, на ваше усмотрение).</p><br/>
<p>Пусть мы определили коэффициенты b0, b1, b2, a1 и a2 (a0 по условию равен 1) по рассчитанным формулам. Алгоритм работы фильтра сводится к свертке, которая делается последовательно для каждого семпла:</p><br/>
<div style="text-align:center;"></div><br/>
<p>y(n) — это новое значение семпла, которое нужно рассчитать. x(n) — текущее значение семпла, соответственно y(n-1) и y(n-2) — предыдущие 2 рассчитанных семпла, а x(n-1) и x(n-2) — предыдущие входные значения семплов.</p><br/>
<p>Нужно организовать запоминание предыдущих семплом. Не будем мудрить с циклическими буферами, сделаем просто и понятно: два массива из трех элементов. Каждый раз будем "проталкивать" новые значения в этот массив, последовательно копируя более старые значения семплов.</p><br/>
<p>Получаем простой класс:</p><br/>
<pre><code>class BiquadConvolutionTable
{
    public double B0, B1, B2, A1, A2;

    private readonly double[] _x = new double[3];
    private readonly double[] _y = new double[3];

    public double Process(double s)
    {
        // "сдвигаем" предыдущие семплы
        _x[2] = _x[1];
        _x[1] = _x[0];
        _x[0] = s;

        _y[2] = _y[1];
        _y[1] = _y[0];

        // свертка
        _y[0] = B0 * _x[0] + B1 * _x[1] + B2 * _x[2] - A1 * _y[1] - A2 * _y[2];

        return _y[0];
    }
}</code><div class="code-explainer"><a href="https://sourcecraft.dev/" class="tm-button code-explainer__link" style="visibility: hidden;"></a></div></pre><br/>
<p>Напишем каркасный класс для фильтра (смотри архитектуру синтезатора в <a href="https://habrahabr.ru/post/311220/">первой статье</a>). Класс BiquadConvolutionTable работает с одним сигналом, т.е. с одним каналом — моно. Поэтому нам нужны две BiquadConvolutionTable — для левого и правого каналов.</p><br/>
<p>Чтобы корректно применить фильтр, нужно последовательно, для всех семплов входящей последовательности применить функцию BiquadConvolutionTable.Process и заполнить результирующий массив семплов.</p><br/>
<p>Рассчетом коэффициентов для BiquadConvolutionTable будет заниматься функция CalculateCoefficients.</p><br/>
<pre><code>public enum EFilterPass
{
    None,

    LowPass,
    HiPass,
    BandPass
}

public class ButterworthFilter : SyntageAudioProcessorComponentWithParameters&lt;AudioProcessor&gt;, IProcessor
{
    private readonly BiquadConvolutionTable _tablel;
    private readonly BiquadConvolutionTable _tabler;

    public EnumParameter&lt;EFilterPass&gt; FilterType { get; private set; }
    public FrequencyParameter CutoffFrequency { get; private set; }

    public ButterworthFilter(AudioProcessor audioProcessor) : base(audioProcessor)
    {
        _tablel = new BiquadConvolutionTable();
        _tabler = new BiquadConvolutionTable();
    }

    public override IEnumerable&lt;Parameter&gt; CreateParameters(string parameterPrefix)
    {
        FilterType = new EnumParameter&lt;EFilterPass&gt;(parameterPrefix + "Pass", "Filter Type", "Filter", false);
        CutoffFrequency = new FrequencyParameter(parameterPrefix + "Cutoff", "Filter Cutoff Frequency", "Cutoff");

        return new List&lt;Parameter&gt; {FilterType, CutoffFrequency};
    }

    public void Process(IAudioStream stream)
    {
        if (FilterType.Value == EFilterPass.None)
            return;

        var count = Processor.CurrentStreamLenght;
        var lc = stream.Channels[0];
        var rc = stream.Channels[1];
        for (int i = 0; i &lt; count; ++i)
        {
            var cutoff = CutoffFrequency.Value;
            CalculateCoefficients(cutoff);

            var ls = _tablel.Process(lc.Samples[i]);
            lc.Samples[i] = ls;

            var rs = _tabler.Process(rc.Samples[i]);
            rc.Samples[i] = rs;
        }
    }

    private void CalculateCoefficients(double cutoff)
    {
        ...
    }
}</code><div class="code-explainer"><a href="https://sourcecraft.dev/" class="tm-button code-explainer__link" style="visibility: hidden;"></a></div></pre><br/>
<p>Функция CalculateCoefficients вызывается каждый раз в цикле — зачем? В следующей статье я расскажу про модуляцию (изменение во времени) параметров, и поэтому, частота среза может меняться, а значит, нужно перерассчитывать коэффициенты. Конечно, по-трушному, нужно подписаться на изменение частоты среза и уже в обработчике рассчитывать коэффициенты. Но в этих статьях я оптимизами заниматься не буду, цель — закодить фильтр.</p><br/>
<p>Осталось закодить функцию CalculateCoefficients по рассчитаным формулам для коэффициентов.<br/>
Вспомним, что нужно использовать денормированные частоты, т.е. произвести замену:</p><br/>
<div style="text-align:center;"></div><br/>
<p>Списываем все формулы для коэффициентов b0, b1, b2, a0, a1, a2. После рассчетов нужно поделить все коэффициенты на a0, чтобы a0 стало равно 1.</p><br/>
<pre><code>private double TransformFrequency(double w)
{
    return Math.Tan(Math.PI * w / Processor.SampleRate);
}

private void CalculateCoefficients(double cutoff)
{
    double b0, b1, b2, a0, a1, a2;

    switch (FilterType.Value)
    {
        case EFilterPass.LowPass:
        {
            var w = TransformFrequency(cutoff);

            a0 = 1 + Math.Sqrt(2) * w + w * w;
            a1 = -2 + 2 * w * w;
            a2 = 1 - Math.Sqrt(2) * w + w * w;

            b0 = w * w;
            b1 = 2 * w * w;
            b2 = w * w;
        }

            break;

        case EFilterPass.HiPass:
        {
            var w = TransformFrequency(cutoff);

            a0 = 1 + Math.Sqrt(2) * w + w * w;
            a1 = -2 + 2 * w * w;
            a2 = 1 - Math.Sqrt(2) * w + w * w;

            b0 = 1;
            b1 = -2;
            b2 = 1;
        }

            break;

        case EFilterPass.BandPass:
        {
            var w = cutoff;
            var d = w / 4;

            // определим полосу фильтра как [w * 3 / 4, w * 5 / 4]
            var w1 = Math.Max(w - d, CutoffFrequency.Min);
            var w2 = Math.Min(w + d, CutoffFrequency.Max);
            w1 = TransformFrequency(w1);
            w2 = TransformFrequency(w2);

            var w0Sqr = w2 * w1; // w0^2
            var wd = w2 - w1; // W

            a0 = -1 - wd - w0Sqr;
            a1 = 2 - 2 * w0Sqr;
            a2 = -1 + wd - w0Sqr;
            b0 = -wd;
            b1 = 0;
            b2 = wd;
        }

            break;

        default:
            throw new ArgumentOutOfRangeException();
    }

    _tablel.B0 = _tabler.B0 = b0 / a0;
    _tablel.B1 = _tabler.B1 = b1 / a0;
    _tablel.B2 = _tabler.B2 = b2 / a0;
    _tablel.A1 = _tabler.A1 = a1 / a0;
    _tablel.A2 = _tabler.A2 = a2 / a0;
}</code><div class="code-explainer"><a href="https://sourcecraft.dev/" class="tm-button code-explainer__link" style="visibility: hidden;"></a></div></pre><br/>
<div class="spoiler"><b class="spoiler_title">Полный код класса ButterworthFilter</b><div class="spoiler_text"><pre><code>public enum EFilterPass
{
    None,

    LowPass,
    HiPass,
    BandPass
}

public class ButterworthFilter : SyntageAudioProcessorComponentWithParameters&lt;AudioProcessor&gt;, IProcessor
{
    private class BiquadConvolutionTable
    {
        public double B0, B1, B2, A1, A2;

        private readonly double[] _x = new double[3];
        private readonly double[] _y = new double[3];

        public double Process(double s)
        {
            // "сдвигаем" предыдущие семплы
            _x[2] = _x[1];
            _x[1] = _x[0];
            _x[0] = s;

            _y[2] = _y[1];
            _y[1] = _y[0];

            // свертка
            _y[0] = B0 * _x[0] + B1 * _x[1] + B2 * _x[2] - A1 * _y[1] - A2 * _y[2];

            return _y[0];
        }
    }

    private readonly BiquadConvolutionTable _tablel;
    private readonly BiquadConvolutionTable _tabler;

    public EnumParameter&lt;EFilterPass&gt; FilterType { get; private set; }
    public FrequencyParameter CutoffFrequency { get; private set; }

    public ButterworthFilter(AudioProcessor audioProcessor) : base(audioProcessor)
    {
        _tablel = new BiquadConvolutionTable();
        _tabler = new BiquadConvolutionTable();
    }

    public override IEnumerable&lt;Parameter&gt; CreateParameters(string parameterPrefix)
    {
        FilterType = new EnumParameter&lt;EFilterPass&gt;(parameterPrefix + "Pass", "Filter Type", "Filter", false);
        CutoffFrequency = new FrequencyParameter(parameterPrefix + "Cutoff", "Filter Cutoff Frequency", "Cutoff");

        return new List&lt;Parameter&gt; {FilterType, CutoffFrequency};
    }

    public void Process(IAudioStream stream)
    {
        if (FilterType.Value == EFilterPass.None)
            return;

        var count = Processor.CurrentStreamLenght;
        var lc = stream.Channels[0];
        var rc = stream.Channels[1];
        for (int i = 0; i &lt; count; ++i)
        {
            var cutoff = CutoffFrequency.Value;
            CalculateCoefficients(cutoff);

            var ls = _tablel.Process(lc.Samples[i]);
            lc.Samples[i] = ls;

            var rs = _tabler.Process(rc.Samples[i]);
            rc.Samples[i] = rs;
        }
    }

    private double TransformFrequency(double w)
    {
        return Math.Tan(Math.PI * w / Processor.SampleRate);
    }

    private void CalculateCoefficients(double cutoff)
    {
        double b0, b1, b2, a0, a1, a2;

        switch (FilterType.Value)
        {
            case EFilterPass.LowPass:
            {
                var w = TransformFrequency(cutoff);

                a0 = 1 + Math.Sqrt(2) * w + w * w;
                a1 = -2 + 2 * w * w;
                a2 = 1 - Math.Sqrt(2) * w + w * w;

                b0 = w * w;
                b1 = 2 * w * w;
                b2 = w * w;
            }

                break;

            case EFilterPass.HiPass:
            {
                var w = TransformFrequency(cutoff);

                a0 = 1 + Math.Sqrt(2) * w + w * w;
                a1 = -2 + 2 * w * w;
                a2 = 1 - Math.Sqrt(2) * w + w * w;

                b0 = 1;
                b1 = -2;
                b2 = 1;
            }

                break;

            case EFilterPass.BandPass:
            {
                var w = cutoff;
                var d = w / 4;

                // определим полосу фильтра как [w * 3 / 4, w * 5 / 4]
                var w1 = Math.Max(w - d, CutoffFrequency.Min);
                var w2 = Math.Min(w + d, CutoffFrequency.Max);
                w1 = TransformFrequency(w1);
                w2 = TransformFrequency(w2);

                var w0Sqr = w2 * w1; // w0^2
                var wd = w2 - w1; // W

                a0 = -1 - wd - w0Sqr;
                a1 = 2 - 2 * w0Sqr;
                a2 = -1 + wd - w0Sqr;
                b0 = -wd;
                b1 = 0;
                b2 = wd;
            }

                break;

            default:
                throw new ArgumentOutOfRangeException();
        }

        _tablel.B0 = _tabler.B0 = b0 / a0;
        _tablel.B1 = _tabler.B1 = b1 / a0;
        _tablel.B2 = _tabler.B2 = b2 / a0;
        _tablel.A1 = _tabler.A1 = a1 / a0;
        _tablel.A2 = _tabler.A2 = a2 / a0;
    }
}</code><div class="code-explainer"><a href="https://sourcecraft.dev/" class="tm-button code-explainer__link" style="visibility: hidden;"></a></div></pre></div></div><br/>
<a name="Part8"></a><br/>
<h2 id="polosovoy-ekvalayzer-v-biblioteke-naudio">Полосовой эквалайзер в библиотеке NAudio</h2><br/>
<p>Для работы с звуком, звуковыми файлами различных форматов на .NET есть хорошая библиотека <a href="https://naudio.codeplex.com/">NAudio</a>.</p><br/>
<p>Она содержит пространство имен NAudio.Dsp с функционалом для фильтрации, <a href="http://ru.wikipedia.org/wiki/Свёртка_(математический_анализ)">свертки</a>, <a href="http://wikisound.org/%D0%93%D0%B5%D0%B9%D1%82">гейта</a>, <a href="https://habrahabr.ru/post/311750/">огибающей</a>, <a href="http://ru.wikipedia.org/wiki/Быстрое_преобразование_Фурье">БПФ</a> и других интересных штук.</p><br/>
<p>Рассмотрим класс Equalizer (из примеров, пространство имен NAudioWpfDemo.EqualizationDemo), позволяющий производить эквализацию сигнала. Класс реализует ISampleProvider, который в функции Read(float[] buffer, int offset, int count) обрабатывает (изменяет) массив семплов buffer.</p><br/>
<p>Конструктор принимает массив структуры EqualizerBand, которые описывают "полосы" эквалайзера:</p><br/>
<pre><code>class EqualizerBand
{
    public float Frequency { get; set; }
    public float Gain { get; set; }
    public float Bandwidth { get; set; }
}</code><div class="code-explainer"><a href="https://sourcecraft.dev/" class="tm-button code-explainer__link" style="visibility: hidden;"></a></div></pre><br/>
<p>Здесь Frequency — центральная частота полосы с параметром Q (Bandwidth, <a href="http://ru.wikipedia.org/wiki/Добротность">добротность фильтра</a>), c усилением Gain dB.</p><br/>
<p>Если заглянуть в реализацию, то каждой полосе EqualizerBand соответствует класс BiQuadFilter который используется как полосовой (Peaking) фильтр. Все фильтры изменяют сигнал используются последовательно.</p><br/>
<p>Класс EqualizerBand является реализацией фильтра Баттервота, с большим выборов типов фильтров и параметрами. Если посмотреть реализацию, можно увидеть схожие формулы и коэффициенты.</p><br/>
<p>Пример использования класса Equalizer вы найдете в проекте NAudioWpfDemo в классе EqualizationDemoViewModel.</p><br/>
<a name="Part9"></a><br/>
<h2 id="programmy-dlya-rasscheta-filtrov">Программы для рассчета фильтров</h2><br/>
<p>Прародителем цифровых фильтров были фильтры аналоговые. Теория для аналоговых схем и аналоговой обработке сигналов в дальнейшем переросла в теорию цифровой обработки сигналов.</p><br/>
<p>Для рассмотренного фильтра Баттервота и рассчитанных формул для коэффициентов можно собрать аналоговую схему.</p><br/>
<p>Есть много программ для рассчета и построения схем, параметров элементов для них, сверточных коэффициентов различных фильтров.<br/>
Можете погуглить по "filter calculation software".</p><br/>
<div style="text-align:center;"></div><br/>
<p><em>Iowa Hills Software RF Filter Designer</em></p><br/>
<p>В следующей статье я расскажу про <a href="http://ru.wikipedia.org/wiki/Дилэй">эффект delay</a>, <a href="http://ru.wikipedia.org/wiki/Дисторшн">distortion</a> и модуляцию параметров.</p><br/>
<p><em>Всем добра! Удачи в программировании!</em></p><br/>
<a name="Part10"></a><br/>
<h2 id="spisok-literatury">Список литературы</h2><br/>
<p>Не забывайте смотреть списки статей и книг в предыдущих статьях.</p><br/>
<ol>
<li><a href="https://www.amazon.com/Digital-Signal-Processing-Practical-Approach/dp/0201596199">Digital Signal Processing: A Practical Approach</a>. Русская версия — <a href="https://www.ozon.ru/context/detail/id/5689080/">Цифровая обработка сигналов. Практический подход</a>.</li>
<li><a href="https://habrahabr.ru/post/196374/">Хабр-статья "Простыми словами о преобразовании Фурье"</a></li>
<li><a href="http://ru.wikipedia.org/wiki/Фильтр_Баттерворта">Фильтр Баттерворта на вики</a></li>
<li><a href="https://github.com/ruohoruotsi/Butterworth-Filter-Design">Github-репозитарий с кодом для рассчета фильтров Баттервота</a></li>
<li><a href="http://abut.sdsu.edu/TE302/Chap7.pdf">DISCRETE SIGNALS AND SYSTEMS, Chapter 7. FIR and IIR Filters</a></li>
<li><a href="http://dsp.stackexchange.com/questions/8693/how-does-a-low-pass-filter-programmatically-work">How does a low-pass filter programmatically work? (dsp.stackexchange.com/)</a></li>
<li><a href="http://mymbs.mbs.net/~pfisher/FOV2-0010016C/FOV2-0010016E/FOV2-001001A3/chapters/25katsianos/index.html">Designing Digital Butterworth and Chebyshev Filters</a></li>
<li><a href="http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt">Audio EQ Cookbook</a></li>
<li><a href="http://www.iowahills.com/8DownloadPage.html">Iowa Hills Software — Digital and Analog Filters</a></li>
</ol></div></div></div><!----><!----></div><!----><!----></div><!--]--><!----><div class="tm-article-presenter__meta" data-test-id="article-meta-links"><div class="tm-separated-list tag-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[.NET]" class="link"><span>.NET</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[%D0%A1%23]" class="link"><span>С#</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[VST]" class="link"><span>VST</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[VSTi]" class="link"><span>VSTi</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[VST+.NET]" class="link"><span>VST .NET</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[DSP]" class="link"><span>DSP</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[%D0%A6%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D1%8F+%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0+%D1%81%D0%B8%D0%B3%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2]" class="link"><span>Цифровая обработка сигналов</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[%D1%81%D0%B8%D0%BD%D1%82%D0%B5%D0%B7%D0%B0%D1%82%D0%BE%D1%80]" class="link"><span>синтезатор</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[%D1%81%D0%B8%D0%BD%D1%82%D0%B5%D0%B7+%D0%B7%D0%B2%D1%83%D0%BA%D0%B0]" class="link"><span>синтез звука</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80+%D1%87%D0%B0%D1%81%D1%82%D0%BE%D1%82]" class="link"><span>фильтр частот</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80+%D0%B1%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%B2%D0%BE%D1%82%D0%B0]" class="link"><span>фильтр баттервота</span></a><!--]--></li><!--]--><!----></ul></div><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a href="/ru/hubs/net/" class="link"><!--[--><span>.NET</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/hubs/algorithms/" class="link"><!--[--><span>Алгоритмы</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/hubs/programming/" class="link"><!--[--><span>Программирование</span><!--]--></a><!--]--></li><!--]--><!----></ul></div></div><!----><!--]--></article><!--]--></div><!----></div><div style="" class="tm-article-sticky-panel" data-test-id="article-sticky-panel"><div class="tm-data-icons tm-data-icons tm-data-icons_space-big tm-article-sticky-panel__icons" data-test-id="article-stats-icons"><div class="article-rating tm-data-icons__item" data-v-b9b05a90><div class="tm-votes-meter votes-switcher" data-v-b9b05a90><svg class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article" height="24" width="24"><title>Всего голосов 29: ↑28 и ↓1</title><use xlink:href="/img/megazord-v28.cba4c116..svg#counter-rating"></use></svg><span class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating tm-votes-meter__value" data-test-id="votes-meter-value" title="Всего голосов 29: ↑28 и ↓1">+25</span></div><!--teleport start--><!--teleport end--><!----></div><!----><!----><button class="bookmarks-button tm-data-icons__item" title="Добавить в закладки" type="button" data-v-861e2740><span class="tm-svg-icon__wrapper icon" data-v-861e2740><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Добавить в закладки</title><use xlink:href="/img/megazord-v28.cba4c116..svg#counter-favorite"></use></svg></span><span class="counter" title="Количество пользователей, добавивших публикацию в закладки" data-v-861e2740>113</span></button><div class="sharing tm-data-icons__item" title="Поделиться" data-v-daf6ee1d><button class="sharing-button" type="button" data-v-daf6ee1d><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-daf6ee1d><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button><!--teleport start--><!--teleport end--></div><div class="article-comments-counter-link-wrapper tm-data-icons__item" title="Читать комментарии" data-v-8d952463><a href="/ru/articles/313062/comments/" class="article-comments-counter-link" data-test-id="counter-comments" data-v-8d952463><!--[--><svg class="tm-svg-img icon" height="24" width="24" data-v-8d952463><title>Комментарии</title><use xlink:href="/img/megazord-v28.cba4c116..svg#counter-comments"></use></svg><span class="value" data-v-8d952463>12</span><!--]--></a><!----></div><!--[--><!--[--><!--[--><!----><!--]--><!--]--><!--]--><!--teleport start--><!--teleport end--><!----></div></div></div><!--[--><!--]--><div class="tm-article-presenter__footer"><!--[--><!--[--><div class="tm-article-blocks"><!----><!--[--><section class="tm-block tm-block tm-block_spacing-bottom"><!----><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><!--[--><div class="article-author" data-test-id="article-author-info" data-async-called="true" data-v-af0d0f90><!--[--><!--]--><div class="tm-user-card tm-user-card tm-user-card_variant-article user-card" data-async-called="true" data-v-af0d0f90><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/lis355/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><!--[--><div class="tm-entity-image"></div><!--]--></a><div class="tm-user-card__meta"><div class="tm-counter-container karma" title=" 55 голосов " data-v-544d285f><div class="tm-counter-container__header"><!--[--><div class="karma-display positive" data-v-544d285f data-v-3881f4ba>53</div><!----><!--]--></div><div class="tm-counter-container__footer"><!--[--><div class="karma-text" data-v-544d285f>Карма</div><!--teleport start--><!--teleport end--><!--]--></div></div><div class="tm-counter-container"><div class="tm-counter-container__header"><!--[--><!--[--><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----><div class="tm-votes-lever__score tm-votes-lever__score_appearance-rating tm-votes-lever__score" data-test-id="lever-score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_rating tm-votes-lever__score-counter" data-test-id="votes-score-counter">7</span></span><!--]--></div><!----></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text">Общий рейтинг</span><!--]--></div></div></div></div></div><div class="tm-user-card__info tm-user-card__info_variant-article tm-user-card__info"><div class="tm-user-card__title tm-user-card__title_variant-article tm-user-card__title"><span class="tm-user-card__name tm-user-card__name_variant-article tm-user-card__name">Иван Ларцов</span><a href="/ru/users/lis355/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article"><!--[-->@lis355<!--]--></a><!----></div><p class="tm-user-card__short-info tm-user-card__short-info_variant-article tm-user-card__short-info" data-test-id="user-card-speciality">Кодер-музыкант</p></div></div><!----><div class="tm-user-card__buttons tm-user-card__buttons_variant-article tm-user-card__buttons"><!----><div class="tm-user-card__button"><div class="tm-button-follow tm-user-card__button-follow"><!----><button class="tm-button-follow__button tm-button-follow__button_big" data-test-id="follow-button" type="button">Подписаться</button></div></div><!----><!--[--><div class="tm-user-card__button tm-user-card__button_write" data-test-id="user-card-conversations"><svg class="tm-svg-img tm-user-card__button-icon" height="16" width="16"><title>Отправить сообщение</title><use xlink:href="/img/megazord-v28.cba4c116..svg#mail"></use></svg></div><!--]--><!----><!----></div><!----></div><div class="author-contacts" data-test-id="author-contacts" data-v-af0d0f90><!----><!----><!--[--><a class="contact" data-test-id="author-contact-link" href="https://lis355.github.io/#/me" rel="noopener" target="_blank" data-v-af0d0f90>Сайт</a><a class="contact" data-test-id="author-contact-link" href="https://t.me/ivanlartsov" rel="noopener" target="_blank" data-v-af0d0f90>Сайт</a><!--]--></div></div><!--]--></div><!--]--><!----></section><!----><!--[--><div class="sponsor-block" style="--d75346b8:0;--11dbf66e:100%;" data-v-580b3119><div class="title" data-v-580b3119>Хабр доступен 24/7 благодаря поддержке друзей</div><div class="content-container" data-v-580b3119><div class="content" data-v-580b3119><div class="content-title-container" data-v-580b3119><div class="content-title" data-v-580b3119>Хабр Курсы для всех</div><div class="sponsor-mark" data-v-580b3119>РЕКЛАМА</div></div><div class="content-text" data-v-580b3119> Практикум, Хекслет, SkyPro, авторские курсы — собрали всех и попросили скидки. Осталось выбрать! </div><a class="content-action" href="https://career.habr.com/courses/?erid=2VSb5wDLYUH&amp;utm_source=habr&amp;utm_medium=sponsorship_hub" target="_blank" data-v-580b3119><button class="btn btn_solid btn_small tm-button_color-horizon" tabindex="0" type="button" data-v-580b3119><!--[--><!--[-->Перейти<!--]--><!--]--></button></a></div></div><div class="footer" data-v-580b3119><!----></div><!----></div><!--]--><!--]--><div class="tm-article-blocks__comments"><div id="publication-comments" class="tm-article-page-comments"><div><!--[--><div class="article-comments-counter-link-wrapper tm-article-comments-counter-button" data-v-8d952463><a href="/ru/articles/313062/comments/" class="article-comments-counter-link button-style" data-test-id="counter-comments" data-v-8d952463><!--[--><svg class="tm-svg-img icon icon--contrasted" height="24" width="24" data-v-8d952463><title>Комментарии</title><use xlink:href="/img/megazord-v28.cba4c116..svg#counter-comments"></use></svg><span class="value value--contrasted" data-v-8d952463> Комментарии 12 </span><!--]--></a><!----></div><!--]--></div></div></div><!--[--><!--[--><!--]--><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2><!--[--><!--]--></div><!----></header><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><!--[--><!--[--><div class="tabs" data-test-id="container" data-v-681e7545><div class="" data-test-id="scroll-area" data-v-681e7545><!--[--><span class="tab-item" data-v-681e7545><button class="active slim tab-link" data-v-681e7545>Лучшие за сутки</button></span><span class="tab-item" data-v-681e7545><button class="slim tab-link" data-v-681e7545>Похожие</button></span><!--]--></div><!----></div><div class="similar-and-daily__tab-view"><div class="daily-articles-list"><ul class="article-card-list" data-v-7f7081d6><!--[--><!--]--><div class="tm-bordered-card" data-v-7f7081d6><!----><!--[--><!--]--></div></ul><div class="daily-articles-block__button-container"><button class="btn btn_transparent btn_small tm-button_color-horizon" tabindex="0" type="button"><!--[--><!--[-->Показать лучшие за всё время<!--]--><!--]--></button></div></div><!----></div><!--]--><!--]--></div><!--]--><!----></section><!--[--><div><div class="placeholder-wrapper"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="tm-placeholder-promo"><div class="tm-placeholder-promo__header"><div class="tm-placeholder__line tm-placeholder__line_promo-title"></div></div><div class="tm-placeholder-promo__body"><div class="tm-placeholder-promo__posts"><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div></div><div class="tm-placeholder-promo__dots"><div class="tm-placeholder-promo__dot"></div><div class="tm-placeholder-promo__dot"></div><div class="tm-placeholder-promo__dot"></div></div></div></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div></div><div><div class="placeholder-wrapper"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="tm-placeholder-inset tm-placeholder-salary"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div><div class="tm-placeholder-salary__body"><div class="tm-placeholder-salary__text"><div class="tm-placeholder__line tm-placeholder__line_salary_average"></div><div class="tm-placeholder-salary__description"><div class="tm-placeholder__line loads"></div><div class="tm-placeholder__line loads"></div><div class="tm-placeholder__line loads"></div><div class="tm-placeholder__line loads"></div></div></div><div class="tm-placeholder-salary__image loads"></div></div><div class="tm-placeholder-inset__footer tm-placeholder-inset__footer_salary"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div></div><!--]--><!----><!--[--><!--]--><!--]--></div><!----><!--]--><!--]--></div></div><!--]--></div><!--]--></div></div><div class="tm-page__sidebar"><!--[--><div class="sidebar" data-v-0050f56d><div id="sidebar-window-placement" data-v-0050f56d></div><!--[--><!--]--></div><!--]--></div></div><!--]--></div><!----></div></main><!----></div><div class="tm-footer-menu"><div class="tm-page-width"><!--[--><div class="tm-footer-menu__container"><!--[--><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Ваш аккаунт</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/articles/313062/&amp;hl=ru" rel="nofollow" target="_self">Войти</a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/articles/313062/&amp;hl=ru" rel="nofollow" target="_self">Регистрация</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Разделы</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="/ru/articles/" class="footer-menu__item-link">Статьи</a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">Новости</a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">Хабы</a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">Компании</a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">Авторы</a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">Песочница</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Информация</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">Устройство сайта</a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">Для авторов</a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">Для компаний</a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">Документы</a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement/?hl=ru_RU" target="_blank">Соглашение</a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/?hl=ru_RU" target="_blank">Конфиденциальность</a></li><!--]--></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">Услуги</p><div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><!--[--><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">Корпоративный блог</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">Медийная реклама</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">Нативные проекты</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">Образовательные программы</a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">Стартапам</a></li><!--]--></ul></div></div><!--]--></div><!--]--></div></div><div class="tm-footer"><div class="tm-page-width"><!--[--><div class="tm-footer__container"><!----><div class="social-icons tm-footer__social" data-v-d6e8cb42><!--[--><a class="tm-svg-icon__wrapper social-icon" href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" data-v-d6e8cb42><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>VK</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-vk"></use></svg></a><a class="tm-svg-icon__wrapper social-icon" href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" data-v-d6e8cb42><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Telegram</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a class="tm-svg-icon__wrapper social-icon" href="http://www.youtube.com/@Habr_com" rel="nofollow noopener noreferrer" target="_blank" data-v-d6e8cb42><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Youtube</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a class="tm-svg-icon__wrapper social-icon" href="https://dzen.ru/habr" rel="nofollow noopener noreferrer" target="_blank" data-v-d6e8cb42><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Яндекс Дзен</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-dzen"></use></svg></a><!--]--></div><!--teleport start--><!--teleport end--><button class="tm-footer__link"><!----> Настройка языка</button><a href="/ru/feedback/" class="tm-footer__link">Техническая поддержка</a><div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2026,</span><span class="tm-copyright__name"><a class="tm-copyright__link" href="https://company.habr.com/" rel="noopener" target="_blank"> Habr </a></span></span></div></div><!--]--></div></div><!----><!----><!--]--></div><!----></div></div>
    <div id="overlays"><!--teleport start anchor--><template><!----></template><!--teleport anchor--><!--teleport start anchor--><template><!----></template><!--teleport anchor--><!--teleport start anchor--><template><!----></template><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor--></div>
    
    
    
    
  
  
    
  
    </body>

    </html>
